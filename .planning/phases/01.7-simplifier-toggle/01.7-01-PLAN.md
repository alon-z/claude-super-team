---
phase: 01.7-simplifier-toggle
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - plugins/claude-super-team/skills/execute-phase/SKILL.md
  - .planning/STATE.md
autonomous: true
quick_phase: true

must_haves:
  truths:
    - "A `simplifier` preference in STATE.md controls whether the code-simplifier step runs during execution"
    - "Execute-phase respects the setting in both task mode and teams mode, skipping simplification when disabled"
  artifacts:
    - "plugins/claude-super-team/skills/execute-phase/SKILL.md (updated)"
    - ".planning/STATE.md (updated with simplifier preference)"
  key_links: []
---

<objective>
Add a per-project toggle to disable the code-simplifier agent step in execute-phase. When `simplifier: disabled` is set in STATE.md Preferences, the simplifier invocation is skipped in both task mode (Phase 5e) and teams mode (Phase 5c teammate prompt). Default behavior remains unchanged (enabled).

Purpose: Some projects do not benefit from the simplifier pass, and it adds execution time. Users need a way to turn it off persistently without per-run flags.
Output: Updated execute-phase SKILL.md with preference-reading logic and conditional simplifier gating; STATE.md updated with the new preference defaulted to enabled.
</objective>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01.7-simplifier-toggle/01.7-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add simplifier preference reading to execute-phase and gate both invocation sites</name>
  <files>plugins/claude-super-team/skills/execute-phase/SKILL.md</files>
  <action>
Add a new step "Phase 3.6: Resolve Simplifier Preference" immediately after Phase 3.5 in execute-phase SKILL.md. This step reads `.planning/STATE.md` and checks for `simplifier` in the `## Preferences` section. If found, set `$SIMPLIFIER_PREF` to the value (`enabled` or `disabled`). If not found, default to `enabled` (no user prompt -- silent default per context decision). Log the resolved value: "Simplifier: {enabled|disabled}". Then gate the two simplifier invocation sites: (1) In Phase 5e (task mode), wrap the entire simplifier Task() call in a conditional: "If `$SIMPLIFIER_PREF` = `enabled`:" before the existing block, and add an else branch that prints "Simplifier disabled -- skipping code simplification for {phase}-{plan}." (2) In Phase 5c (teams mode), add a conditional to the teammate prompt instructions: change the simplifier instruction line from unconditional to "If simplifier is enabled ($SIMPLIFIER_PREF = enabled): After completing ALL tasks, run the code-simplifier agent..." and add "If simplifier is disabled: skip the code-simplifier step and proceed directly to writing SUMMARY.md." Also update the Phase 5e section heading from "#### 5e. Simplify Code" to include "(Conditional)" and update the Flow line in the Objective section to note the conditional: "simplify code (if enabled)".
  </action>
  <verify>Read the updated SKILL.md and confirm: (1) Phase 3.6 exists between 3.5 and 4, (2) Phase 5e has a conditional check on $SIMPLIFIER_PREF, (3) Phase 5c teammate prompt has a conditional for the simplifier instruction, (4) the Flow line reflects the conditional.</verify>
  <done>Execute-phase SKILL.md contains a preference-reading step and both simplifier call sites are gated by the $SIMPLIFIER_PREF variable.</done>
</task>

<task type="auto">
  <name>Task 2: Add simplifier preference to STATE.md</name>
  <files>.planning/STATE.md</files>
  <action>
Add `simplifier: enabled` to the `## Preferences` section in STATE.md, on the line after `execution-model: opus`. This establishes the default for this project and demonstrates the preference format for users.
  </action>
  <verify>Read STATE.md and confirm the Preferences section contains both `execution-model: opus` and `simplifier: enabled` on consecutive lines.</verify>
  <done>STATE.md Preferences section includes `simplifier: enabled` alongside the existing `execution-model` preference.</done>
</task>

</tasks>

<verification>
1. Read execute-phase SKILL.md and confirm Phase 3.6 (Resolve Simplifier Preference) exists with correct logic
2. Confirm Phase 5e (task mode) simplifier call is wrapped in $SIMPLIFIER_PREF conditional
3. Confirm Phase 5c (teams mode) teammate prompt includes conditional simplifier instruction
4. Read STATE.md and confirm `simplifier: enabled` is in Preferences section
5. Confirm no other behavioral changes were introduced
</verification>

<success_criteria>
- STATE.md `## Preferences` contains `simplifier: enabled` (or `disabled` when user changes it)
- Execute-phase reads the preference in Phase 3.6 and sets $SIMPLIFIER_PREF
- Task mode (Phase 5e) skips simplifier when $SIMPLIFIER_PREF = disabled
- Teams mode (Phase 5c) teammate prompt conditionally includes simplifier step
- Default behavior (no preference set or `enabled`) matches current behavior exactly
</success_criteria>

<output>
After completion, create `.planning/phases/01.7-simplifier-toggle/01.7-01-SUMMARY.md`
</output>
