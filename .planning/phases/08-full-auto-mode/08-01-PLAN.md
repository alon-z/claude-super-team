---
phase: 08-full-auto-mode
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - plugins/claude-super-team/skills/build/gather-data.sh
  - plugins/claude-super-team/skills/build/assets/build-state-template.md
  - plugins/claude-super-team/skills/build/assets/build-preferences-template.md
  - plugins/claude-super-team/skills/build/assets/build-report-template.md
autonomous: true

must_haves:
  truths:
    - "gather-data.sh outputs BUILD_STATE, PREFERENCES, GIT, PROJECT, and BROWNFIELD sections"
    - "build-state-template.md contains all sections from RESEARCH.md code examples"
    - "build-preferences-template.md documents all preference sections"
    - "build-report-template.md has placeholders for decisions log, validation results, and incomplete phases"
  artifacts:
    - path: "plugins/claude-super-team/skills/build/gather-data.sh"
      provides: "Dynamic context injection script for /build"
    - path: "plugins/claude-super-team/skills/build/assets/build-state-template.md"
      provides: "Template for .planning/BUILD-STATE.md"
    - path: "plugins/claude-super-team/skills/build/assets/build-preferences-template.md"
      provides: "Template for build-preferences.md (global and per-project)"
    - path: "plugins/claude-super-team/skills/build/assets/build-report-template.md"
      provides: "Template for .planning/BUILD-REPORT.md"
  key_links:
    - from: "plugins/claude-super-team/skills/build/gather-data.sh"
      to: ".planning/BUILD-STATE.md"
      via: "cat and existence checks"
    - from: "plugins/claude-super-team/skills/build/gather-data.sh"
      to: "~/.claude/build-preferences.md"
      via: "cat with fallback"
---

<objective>
Create the /build skill's foundation layer: the gather-data.sh dynamic context injection script and all three asset templates (build-state, build-preferences, build-report).

Purpose: These files must exist before the SKILL.md is written because the SKILL.md references them for state initialization, preference loading, and report generation. The gather-data.sh script is invoked via `!` dynamic context injection in the SKILL.md frontmatter area.

Output: 4 files in `plugins/claude-super-team/skills/build/` -- the gather script and 3 templates.
</objective>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-full-auto-mode/08-CONTEXT.md
@.planning/phases/08-full-auto-mode/08-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create gather-data.sh for /build skill</name>
  <files>plugins/claude-super-team/skills/build/gather-data.sh</files>
  <action>
Create `plugins/claude-super-team/skills/build/gather-data.sh` as an executable bash script. Follow the exact pattern from the RESEARCH.md code example (section "gather-data.sh for /build"), adapted from existing gather-data.sh scripts in execute-phase, progress, and phase-feedback.

The script must output these labeled sections (matching the pattern used by all other gather-data.sh scripts in the project):

**=== BUILD_STATE ===**
- Check if `.planning/BUILD-STATE.md` exists
- If yes: `EXISTS=true` then cat the file contents
- If no: `EXISTS=false`

**=== PREFERENCES ===**
- Check `$HOME/.claude/build-preferences.md` for global prefs: `GLOBAL_PREFS=true/false`, cat if exists
- Check `.planning/build-preferences.md` for project prefs: `PROJECT_PREFS=true/false`, cat if exists

**=== GIT ===**
- If git is available (`git rev-parse --git-dir`):
  - `BRANCH=` current branch (or `detached`)
  - `HAS_UNCOMMITTED=` 0 or 1 (check `git status --porcelain`)
  - List all `build/*` branches via `git branch --list 'build/*'` with `BUILD_BRANCH=` prefix
- If git not available: `BRANCH=none`, `GIT_AVAILABLE=false`

**=== PROJECT ===**
- `HAS_PROJECT=true/false` (test -f .planning/PROJECT.md)
- `HAS_ROADMAP=true/false` (test -f .planning/ROADMAP.md)
- `HAS_STATE=true/false` (test -f .planning/STATE.md)
- `HAS_CODEBASE=true/false` (test -d .planning/codebase)

**=== BROWNFIELD ===**
- `CODE_FILES=` count of code files (*.ts, *.js, *.py, *.go, *.rs) in current dir (maxdepth 3, excluding node_modules and .git)

Add shebang `#!/usr/bin/env bash` and a comment header identifying the script purpose. Make the file executable (chmod +x via git or explicit).

First create the directory structure:
```bash
mkdir -p plugins/claude-super-team/skills/build/assets
mkdir -p plugins/claude-super-team/skills/build/references
```
  </action>
  <verify>
Run `bash plugins/claude-super-team/skills/build/gather-data.sh` from the project root and confirm it outputs all 5 sections (BUILD_STATE, PREFERENCES, GIT, PROJECT, BROWNFIELD) without errors. Each section should start with `===` delimiter.
  </verify>
  <done>gather-data.sh exists, is executable, and produces all 5 output sections when run from any directory containing a .planning/ folder (or gracefully handles missing files).</done>
</task>

<task type="auto">
  <name>Task 2: Create build-state, build-preferences, and build-report templates</name>
  <files>
plugins/claude-super-team/skills/build/assets/build-state-template.md
plugins/claude-super-team/skills/build/assets/build-preferences-template.md
plugins/claude-super-team/skills/build/assets/build-report-template.md
  </files>
  <action>
Create three template files in `plugins/claude-super-team/skills/build/assets/`:

**build-state-template.md** -- Template for `.planning/BUILD-STATE.md`. Use the format from RESEARCH.md "BUILD-STATE.md Format" code example. Must include these sections with placeholder values:

```markdown
# Build State

## Session
- **Started:** {timestamp}
- **Input:** {user_input}
- **Input source:** {inline|file|both}
- **Status:** {not_started|in_progress|complete|failed}
- **Current stage:** {pipeline_stage}
- **Current phase:** {N|N/A}
- **Git main branch:** {branch_name}
- **Compaction count:** 0

## Build Preferences
- **Source:** {preference_sources}
- **Exec model:** {opus|sonnet}
- **Tech stack preference:** {from_preferences_or_none}
- **Architecture style:** {from_preferences_or_none}

## Pipeline Progress
| Stage | Status | Started | Completed | Notes |
|-------|--------|---------|-----------|-------|
| input-detection | pending | - | - | - |
| new-project | pending | - | - | - |
| map-codebase | pending | - | - | - |
| brainstorm | pending | - | - | - |
| create-roadmap | pending | - | - | - |

## Phase Progress
| Phase | Discuss | Research | Plan | Execute | Validate | Feedback | Git Merge | Status |
|-------|---------|----------|------|---------|----------|----------|-----------|--------|

## Decisions Log
| # | Phase | Skill | Question | Answer | Confidence |
|---|-------|-------|----------|--------|------------|

## Validation Results
| Phase | Build | Tests | Feedback Attempt | Final Status |
|-------|-------|-------|------------------|--------------|

## Incomplete Phases

## Errors
```

Notes on the template:
- Pipeline Progress tracks the one-time setup stages (new-project, map-codebase, brainstorm, create-roadmap)
- Phase Progress tracks per-phase pipeline steps (discuss through git-merge) -- rows are populated dynamically as ROADMAP.md phases are created
- The two-table approach cleanly separates the one-time pipeline from the per-phase loop
- All Status values follow: pending, in_progress, complete, skipped, failed

**build-preferences-template.md** -- Template for `build-preferences.md`. Use the format from RESEARCH.md "build-preferences.md Format" code example. Include sections with descriptive placeholders:

```markdown
# Build Preferences

## Tech Stack
- **Frontend:** (e.g., React with TypeScript, Vue, Svelte)
- **Backend:** (e.g., Node.js with Express, Python with FastAPI)
- **Database:** (e.g., PostgreSQL with Prisma, SQLite)
- **Auth:** (e.g., OAuth2, JWT, session-based)
- **Styling:** (e.g., Tailwind CSS, CSS Modules)

## Execution Model
- **Preference:** (opus | sonnet)

## Architecture Style
- **Pattern:** (e.g., modular monolith, microservices, serverless)
- **API style:** (e.g., REST, GraphQL, tRPC)

## Coding Style
- **Language:** (e.g., TypeScript strict mode, Python with type hints)
- **Testing:** (e.g., Jest, pytest, vitest)
- **Linting:** (e.g., ESLint + Prettier, ruff)

## Testing Strategy
- **Unit tests:** (required | optional | none)
- **Integration tests:** (required | optional | none)
- **E2E tests:** (required | optional | none)

## Git Preferences
- **Commit style:** (e.g., conventional commits)
- **Branch prefix:** build/
```

**build-report-template.md** -- Template for `.planning/BUILD-REPORT.md`. This is generated at the end of the build pipeline:

```markdown
# Build Report

## Overview
- **Project:** {project_name}
- **Input:** {original_input}
- **Started:** {start_timestamp}
- **Completed:** {end_timestamp}
- **Status:** {complete|partial|failed}

## Pipeline Summary
- **Phases planned:** {N}
- **Phases completed:** {M}
- **Phases incomplete:** {K}
- **Total plans executed:** {P}
- **Feedback loops used:** {F}
- **Compactions survived:** {C}

## Phase Results
| Phase | Name | Status | Validation | Notes |
|-------|------|--------|------------|-------|

## Key Decisions
| # | Phase | Question | Answer | Confidence |
|---|-------|----------|--------|------------|

### Low-Confidence Decisions (Review Recommended)
{filtered list of decisions with confidence = low}

## Validation Summary
| Phase | Build | Tests | Final |
|-------|-------|-------|-------|

### Final Validation
- **Build:** {pass|fail|skipped}
- **Tests:** {pass|fail|skipped|none}
- **Auto-fix attempts:** {0-3}

## Incomplete Items
{list of incomplete phases with reasons}

## Known Issues
{list of errors and unresolved problems from BUILD-STATE.md}

## Files Created
{summary count and key files}

## Next Steps
{recommendations based on build outcome}
```

All templates use `{placeholder}` syntax for values that /build fills dynamically. Section structure is fixed; content is dynamic.
  </action>
  <verify>
Verify all three template files exist:
```bash
test -f plugins/claude-super-team/skills/build/assets/build-state-template.md && echo "build-state OK"
test -f plugins/claude-super-team/skills/build/assets/build-preferences-template.md && echo "build-preferences OK"
test -f plugins/claude-super-team/skills/build/assets/build-report-template.md && echo "build-report OK"
```
Verify build-state-template.md contains all required sections: Session, Build Preferences, Pipeline Progress, Phase Progress, Decisions Log, Validation Results, Incomplete Phases, Errors.
  </verify>
  <done>All three template files exist in assets/ with complete section structures. build-state-template has 8 sections with tables. build-preferences-template has 6 sections. build-report-template has sections for overview, phase results, decisions (with low-confidence filter), validation, incomplete items, and next steps.</done>
</task>

</tasks>

<verification>
1. Directory structure exists: `plugins/claude-super-team/skills/build/{gather-data.sh,assets/,references/}`
2. gather-data.sh is executable and outputs 5 sections without errors
3. All 3 templates exist and contain their required sections
4. Templates use consistent placeholder syntax (`{placeholder}`)
5. gather-data.sh follows the same pattern as other gather-data.sh scripts in the project (echo-based section delimiters, conditional file reads)
</verification>

<success_criteria>
The /build skill's directory structure is created with a working gather-data.sh script and all three asset templates. These files are ready to be referenced by the SKILL.md (Plan 03) and by the reference guides (Plan 02).
</success_criteria>

<output>
After completion, create `.planning/phases/08-full-auto-mode/08-01-SUMMARY.md`
</output>
